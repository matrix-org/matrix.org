<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.12: http://docutils.sourceforge.net/" />
<meta name="description" content="HowTos HTML" />
<title></title>
<style type="text/css">

/*
 * basic.css
 * ~~~~~~~~~
 *
 * Sphinx stylesheet -- basic theme.
 *
 * :copyright: Copyright 2007-2010 by the Sphinx team, see AUTHORS.
 * :license: BSD, see LICENSE for details.
 *
 */

/* -- main layout ----------------------------------------------------------- */

div.clearer {
    clear: both;
}

/* -- relbar ---------------------------------------------------------------- */

div.related {
    width: 100%;
    font-size: 90%;
}

div.related h3 {
    display: none;
}

div.related ul {
    margin: 0;
    padding: 0 0 0 10px;
    list-style: none;
}

div.related li {
    display: inline;
}

div.related li.right {
    float: right;
    margin-right: 5px;
}

/* -- sidebar --------------------------------------------------------------- */

div.sphinxsidebarwrapper {
    padding: 10px 5px 0 10px;
}

div.sphinxsidebar {
    float: left;
    width: 230px;
    margin-left: -100%;
    font-size: 90%;
}

div.sphinxsidebar ul {
    list-style: none;
}

div.sphinxsidebar ul ul,
div.sphinxsidebar ul.want-points {
    margin-left: 20px;
    list-style: square;
}

div.sphinxsidebar ul ul {
    margin-top: 0;
    margin-bottom: 0;
}

div.sphinxsidebar form {
    margin-top: 10px;
}

div.sphinxsidebar input {
    border: 1px solid #98dbcc;
    font-family: sans-serif;
    font-size: 1em;
}

img {
    border: 0;
}

/* -- search page ----------------------------------------------------------- */

ul.search {
    margin: 10px 0 0 20px;
    padding: 0;
}

ul.search li {
    padding: 5px 0 5px 20px;
    background-image: url(file.png);
    background-repeat: no-repeat;
    background-position: 0 7px;
}

ul.search li a {
    font-weight: bold;
}

ul.search li div.context {
    color: #888;
    margin: 2px 0 0 30px;
    text-align: left;
}

ul.keywordmatches li.goodmatch a {
    font-weight: bold;
}

/* -- index page ------------------------------------------------------------ */

table.contentstable {
    width: 90%;
}

table.contentstable p.biglink {
    line-height: 150%;
}

a.biglink {
    font-size: 1.3em;
}

span.linkdescr {
    font-style: italic;
    padding-top: 5px;
    font-size: 90%;
}

/* -- general index --------------------------------------------------------- */

table.indextable {
    width: 100%;
}

table.indextable td {
    text-align: left;
    vertical-align: top;
}

table.indextable dl, table.indextable dd {
    margin-top: 0;
    margin-bottom: 0;
}

table.indextable tr.pcap {
    height: 10px;
}

table.indextable tr.cap {
    margin-top: 10px;
    background-color: #f2f2f2;
}

img.toggler {
    margin-right: 3px;
    margin-top: 3px;
    cursor: pointer;
}

div.modindex-jumpbox {
    border-top: 1px solid #ddd;
    border-bottom: 1px solid #ddd;
    margin: 1em 0 1em 0;
    padding: 0.4em;
}

div.genindex-jumpbox {
    border-top: 1px solid #ddd;
    border-bottom: 1px solid #ddd;
    margin: 1em 0 1em 0;
    padding: 0.4em;
}

/* -- general body styles --------------------------------------------------- */

a.headerlink {
    visibility: hidden;
}

h1:hover > a.headerlink,
h2:hover > a.headerlink,
h3:hover > a.headerlink,
h4:hover > a.headerlink,
h5:hover > a.headerlink,
h6:hover > a.headerlink,
dt:hover > a.headerlink {
    visibility: visible;
}

div.document p.caption {
    text-align: inherit;
}

div.document td {
    text-align: left;
}

.field-list ul {
    padding-left: 1em;
}

.first {
    margin-top: 0 !important;
}

p.rubric {
    margin-top: 30px;
    font-weight: bold;
}

.align-left {
    text-align: left;
}

.align-center {
    clear: both;
    text-align: center;
}

.align-right {
    text-align: right;
}

/* -- sidebars -------------------------------------------------------------- */

div.sidebar {
    margin: 0 0 0.5em 1em;
    border: 1px solid #ddb;
    padding: 7px 7px 0 7px;
    background-color: #ffe;
    width: 40%;
    float: right;
}

p.sidebar-title {
    font-weight: bold;
}

/* -- topics ---------------------------------------------------------------- */

div.topic {
    border: 1px solid #ccc;
    padding: 7px 7px 0 7px;
    margin: 10px 0 10px 0;
}

p.topic-title {
    font-size: 1.1em;
    font-weight: bold;
    margin-top: 10px;
}

/* -- admonitions ----------------------------------------------------------- */

div.admonition {
    margin-top: 10px;
    margin-bottom: 10px;
    padding: 7px;
}

div.admonition dt {
    font-weight: bold;
}

div.admonition dl {
    margin-bottom: 0;
}

p.admonition-title {
    margin: 0px 10px 5px 0px;
    font-weight: bold;
}

div.document p.centered {
    text-align: center;
    margin-top: 25px;
}

/* -- tables ---------------------------------------------------------------- */

table.docutils {
    border: 0;
    border-collapse: collapse;
}

table.docutils td, table.docutils th {
    padding: 1px 8px 1px 5px;
    border-top: 0;
    border-left: 0;
    border-right: 0;
    border-bottom: 1px solid #aaa;
}

table.field-list td, table.field-list th {
    border: 0 !important;
}

table.footnote td, table.footnote th {
    border: 0 !important;
}

th {
    text-align: left;
    padding-right: 5px;
}

table.citation {
    border-left: solid 1px gray;
    margin-left: 1px;
}

table.citation td {
    border-bottom: none;
}

/* -- other body styles ----------------------------------------------------- */

ol.arabic {
    list-style: decimal;
}

ol.loweralpha {
    list-style: lower-alpha;
}

ol.upperalpha {
    list-style: upper-alpha;
}

ol.lowerroman {
    list-style: lower-roman;
}

ol.upperroman {
    list-style: upper-roman;
}

dl {
    margin-bottom: 15px;
}

dd p {
    margin-top: 0px;
}

dd ul, dd table {
    margin-bottom: 10px;
}

dd {
    margin-top: 3px;
    margin-bottom: 10px;
    margin-left: 30px;
}

dt:target, .highlighted {
    background-color: #fbe54e;
}

dl.glossary dt {
    font-weight: bold;
    font-size: 1.1em;
}

.field-list ul {
    margin: 0;
    padding-left: 1em;
}

.field-list p {
    margin: 0;
}

.refcount {
    color: #060;
}

.optional {
    font-size: 1.3em;
}

.versionmodified {
    font-style: italic;
}

.system-message {
    background-color: #fda;
    padding: 5px;
    border: 3px solid red;
}

.footnote:target  {
    background-color: #ffa
}

.line-block {
    display: block;
    margin-top: 1em;
    margin-bottom: 1em;
}

.line-block .line-block {
    margin-top: 0;
    margin-bottom: 0;
    margin-left: 1.5em;
}

.guilabel, .menuselection {
    font-family: sans-serif;
}

.accelerator {
    text-decoration: underline;
}

.classifier {
    font-style: oblique;
}

/* -- code displays --------------------------------------------------------- */

pre {
    overflow: auto;
}

td.linenos pre {
    padding: 5px 0px;
    border: 0;
    background-color: transparent;
    color: #aaa;
}

table.highlighttable {
    margin-left: 0.5em;
}

table.highlighttable td {
    padding: 0 0.5em 0 0.5em;
}

tt.descname {
    background-color: transparent;
    font-weight: bold;
    font-size: 1.2em;
}

tt.descclassname {
    background-color: transparent;
}

tt.xref, a tt {
    background-color: transparent;
    font-weight: bold;
}

h1 tt, h2 tt, h3 tt, h4 tt, h5 tt, h6 tt {
    background-color: transparent;
}

.viewcode-link {
    float: right;
}

.viewcode-back {
    float: right;
    font-family: sans-serif;
}

div.viewcode-block:target {
    margin: -1px -10px;
    padding: 0 10px;
}

/* -- math display ---------------------------------------------------------- */

img.math {
    vertical-align: middle;
}

div.document div.math p {
    text-align: center;
}

span.eqno {
    float: right;
}

/* -- printout stylesheet --------------------------------------------------- */

@media print {
    div.document,
    div.documentwrapper,
    div.bodywrapper {
        margin: 0 !important;
        width: 100%;
    }

    div.sphinxsidebar,
    div.related,
    div.footer,
    #top-link {
        display: none;
    }
}


</style>
<style type="text/css">

pre.code .comment, code .comment { color: green }
pre.code .keyword, code .keyword { color: darkred; font-weight: bold }
pre.code .name.builtin, code .name.builtin { color: darkred; font-weight: bold }
pre.code .name.tag, code .name.tag { color: darkgreen }
pre.code .literal, code .literal { color: darkblue }
pre.code .literal.number, code .literal.number { color: blue }


/* HTTP Methods have class "name function" */
pre.code.http .name.function,  code.http .name.function { color: black; font-weight: bold }
/* HTTP Paths have class "name namespace" */
pre.code.http .name.namespace, code.http .name.namespace { color: darkgreen }
/* HTTP "HTTP" strings have class "keyword reserved" */
pre.code.http .keyword.reserved, code.http .keyword.reserved { color: black; font-weight: bold }
/* HTTP Header names have class "name attribute" */
pre.code.http .name.attribute, code.http .name.attribute { color: black; font-weight: bold }

</style>
<style type="text/css">

/*
 * nature.css_t
 * ~~~~~~~~~~~~
 *
 * Sphinx stylesheet -- nature theme.
 *
 * :copyright: Copyright 2007-2010 by the Sphinx team, see AUTHORS.
 * :license: BSD, see LICENSE for details.
 *
 */

/* -- page layout ----------------------------------------------------------- */

body {
    font-family: Arial, sans-serif;
    font-size: 100%;
    /*background-color: #111;*/
    color: #555;
    margin: 0;
    padding: 0;
}

div.documentwrapper {
    float: left;
    width: 100%;
}

div.bodywrapper {
    margin: 0 0 0 230px;
}

hr {
    border: 1px solid #B1B4B6;
}

/*
div.document {
    background-color: #eee;
}
*/

div.document {
    background-color: #ffffff;
    color: #3E4349;
    padding: 0 30px 30px 30px;
    font-size: 0.9em;
}

div.footer {
    color: #555;
    width: 100%;
    padding: 13px 0;
    text-align: center;
    font-size: 75%;
}

div.footer a {
    color: #444;
    text-decoration: underline;
}

div.related {
    background-color: #6BA81E;
    line-height: 32px;
    color: #fff;
    text-shadow: 0px 1px 0 #444;
    font-size: 0.9em;
}

div.related a {
    color: #E2F3CC;
}

div.sphinxsidebar {
    font-size: 0.75em;
    line-height: 1.5em;
}

div.sphinxsidebarwrapper{
    padding: 20px 0;
}

div.sphinxsidebar h3,
div.sphinxsidebar h4 {
    font-family: Arial, sans-serif;
    color: #222;
    font-size: 1.2em;
    font-weight: normal;
    margin: 0;
    padding: 5px 10px;
    background-color: #ddd;
    text-shadow: 1px 1px 0 white
}

div.sphinxsidebar h4{
    font-size: 1.1em;
}

div.sphinxsidebar h3 a {
    color: #444;
}


div.sphinxsidebar p {
    color: #888;
    padding: 5px 20px;
}

div.sphinxsidebar p.topless {
}

div.sphinxsidebar ul {
    margin: 10px 20px;
    padding: 0;
    color: #000;
}

div.sphinxsidebar a {
    color: #444;
}

div.sphinxsidebar input {
    border: 1px solid #ccc;
    font-family: sans-serif;
    font-size: 1em;
}

div.sphinxsidebar input[type=text]{
    margin-left: 20px;
}

/* -- body styles ----------------------------------------------------------- */

a {
    color: #005B81;
    text-decoration: none;
}

a:hover {
    color: #E32E00;
    text-decoration: underline;
}

div.document h1,
div.document h2,
div.document h3,
div.document h4,
div.document h5,
div.document h6 {
    font-family: Arial, sans-serif;
    background-color: #BED4EB;
    font-weight: normal;
    color: #212224;
    margin: 30px 0px 10px 0px;
    padding: 5px 0 5px 10px;
    text-shadow: 0px 1px 0 white
}

div.document h1 { border-top: 20px solid white; margin-top: 0; font-size: 200%; }
div.document h2 { font-size: 150%; background-color: #C8D5E3; }
div.document h3 { font-size: 120%; background-color: #D8DEE3; }
div.document h4 { font-size: 110%; background-color: #D8DEE3; }
div.document h5 { font-size: 100%; background-color: #D8DEE3; }
div.document h6 { font-size: 100%; background-color: #D8DEE3; }

a.headerlink {
    color: #c60f0f;
    font-size: 0.8em;
    padding: 0 4px 0 4px;
    text-decoration: none;
}

a.headerlink:hover {
    background-color: #c60f0f;
    color: white;
}

div.document p, div.document dd, div.document li {
    line-height: 1.5em;
}

div.admonition p.admonition-title + p {
    display: inline;
}

div.highlight{
    background-color: white;
}

div.note {
    background-color: #eee;
    border: 1px solid #ccc;
}

div.seealso {
    background-color: #ffc;
    border: 1px solid #ff6;
}

div.topic {
    background-color: #eee;
}

div.warning {
    background-color: #ffe4e4;
    border: 1px solid #f66;
}

p.admonition-title {
    display: inline;
}

p.admonition-title:after {
    content: ":";
}

pre {
    padding: 10px;
    background-color: White;
    color: #222;
    line-height: 1.2em;
    border: 1px solid #C6C9CB;
    font-size: 1.1em;
    margin: 1.5em 0 1.5em 0;
    -webkit-box-shadow: 1px 1px 1px #d8d8d8;
    -moz-box-shadow: 1px 1px 1px #d8d8d8;
}

tt {
    background-color: #ecf0f3;
    color: #222;
    /* padding: 1px 2px; */
    font-size: 1.1em;
    font-family: monospace;
}

.viewcode-back {
    font-family: Arial, sans-serif;
}

div.viewcode-block:target {
    background-color: #f4debf;
    border-top: 1px solid #ac9;
    border-bottom: 1px solid #ac9;
}

ul li dd {
	margin-top: 0;
}

ul li dl {
	margin-bottom: 0;
}

li dl dd {
	margin-bottom: 0;
}

dd ul {
	padding-left: 0;
}

li dd ul {
	margin-bottom: 0;
}

table {
    margin-top: 10px;
    margin-bottom: 10px;
    border: 0;
    border-collapse: collapse;
}

td[colspan]:not([colspan="1"]) {
    background: #eeeeee;
}

thead {
    background: #eeeeee;
}

div.admonition-rationale {
    background-color: #efe;
    border: 1px solid #ccc;
}


</style>
<style type="text/css">

blockquote {
    margin: 20px 0 30px;
    border-left: 5px solid;
    padding-left: 20px;
}

</style>
</head>
<body>

<div class="document">


<!-- TODO kegan
Room config (specifically: message history,
public rooms). /register seems super simplistic compared to /login, maybe it
would be better if /register used the same technique as /login? /register should
be "user" not "user_id". -->
<p><a class="anchor" id="how-to-use-the-client-server-api"></a></p>
<div class="section" id="how-to-use-the-client-server-api">
<h1>How to use the client-server API</h1>
%outdatedspecwarning%
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">The git version of this document is <tt class="docutils literal">HEAD,e6af044</tt></p>
</div>
<p>This guide focuses on how the client-server APIs <em>provided by the reference
homeserver</em> can be used. Since this is specific to a homeserver
implementation, there may be variations in relation to registering/logging in
which are not covered in extensive detail in this guide.</p>
<p>If you haven't already, get a homeserver up and running on
<tt class="docutils literal"><span class="pre">http://localhost:8008</span></tt>.</p>
</div>
<p><a class="anchor" id="accounts"></a></p>
<div class="section" id="accounts">
<h1>Accounts</h1>
<p>Before you can send and receive messages, you must <strong>register</strong> for an account.
If you already have an account, you must <strong>login</strong> into it.</p>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="http://jsfiddle.net/gh/get/jquery/1.8.3/matrix-org/matrix-doc/tree/master/supporting-docs/howtos/jsfiddles/register_login">Try out the fiddle</a></p>
</div>
<p><a class="anchor" id="registration"></a></p>
<div class="section" id="registration">
<h2>Registration</h2>
<p>The aim of registration is to get a user ID and access token which you will need
when accessing other APIs:</p>
<pre class="literal-block">
curl -XPOST -d '{&quot;user&quot;:&quot;example&quot;, &quot;password&quot;:&quot;wordpass&quot;, &quot;type&quot;:&quot;m.login.password&quot;}' &quot;http://localhost:8008/_matrix/client/api/v1/register&quot;

{
    &quot;access_token&quot;: &quot;QGV4YW1wbGU6bG9jYWxob3N0.AqdSzFmFYrLrTmteXc&quot;,
    &quot;home_server&quot;: &quot;localhost&quot;,
    &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
}
</pre>
<p>NB: If a <tt class="docutils literal">user</tt> is not specified, one will be randomly generated for you.
If you do not specify a <tt class="docutils literal">password</tt>, you will be unable to login to the account
if you forget the <tt class="docutils literal">access_token</tt>.</p>
<p>Implementation note: The matrix specification does not enforce how users
register with a server. It just specifies the URL path and absolute minimum
keys. The reference homeserver uses a username/password to authenticate user,
but other homeservers may use different methods. This is why you need to
specify the <tt class="docutils literal">type</tt> of method.</p>
</div>
<p><a class="anchor" id="login"></a></p>
<div class="section" id="login">
<h2>Login</h2>
<p>The aim when logging in is to get an access token for your existing user ID:</p>
<pre class="literal-block">
curl -XGET &quot;http://localhost:8008/_matrix/client/api/v1/login&quot;

{
    &quot;flows&quot;: [
        {
            &quot;type&quot;: &quot;m.login.password&quot;
        }
    ]
}

curl -XPOST -d '{&quot;type&quot;:&quot;m.login.password&quot;, &quot;user&quot;:&quot;example&quot;, &quot;password&quot;:&quot;wordpass&quot;}' &quot;http://localhost:8008/_matrix/client/api/v1/login&quot;

{
    &quot;access_token&quot;: &quot;QGV4YW1wbGU6bG9jYWxob3N0.vRDLTgxefmKWQEtgGd&quot;,
    &quot;home_server&quot;: &quot;localhost&quot;,
    &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
}
</pre>
<p>Implementation note: Different homeservers may implement different methods for
logging in to an existing account. In order to check that you know how to login
to this homeserver, you must perform a <tt class="docutils literal">GET</tt> first and make sure you
recognise the login type. If you do not know how to login, you can
<tt class="docutils literal">GET /login/fallback</tt> which will return a basic webpage which you can use to
login. The reference homeserver implementation support username/password login,
but other homeservers may support different login methods (e.g. OAuth2).</p>
</div>
</div>
<p><a class="anchor" id="communicating"></a></p>
<div class="section" id="communicating">
<h1>Communicating</h1>
<p>In order to communicate with another user, you must <strong>create a room</strong> with that
user and <strong>send a message</strong> to that room.</p>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="http://jsfiddle.net/gh/get/jquery/1.8.3/matrix-org/matrix-doc/tree/master/supporting-docs/howtos/jsfiddles/create_room_send_msg">Try out the fiddle</a></p>
</div>
<p><a class="anchor" id="creating-a-room"></a></p>
<div class="section" id="creating-a-room">
<h2>Creating a room</h2>
<p>If you want to send a message to someone, you have to be in a room with them. To
create a room:</p>
<pre class="literal-block">
curl -XPOST -d '{&quot;room_alias_name&quot;:&quot;tutorial&quot;}' &quot;http://localhost:8008/_matrix/client/api/v1/createRoom?access_token=YOUR_ACCESS_TOKEN&quot;

{
    &quot;room_alias&quot;: &quot;#tutorial:localhost&quot;,
    &quot;room_id&quot;: &quot;!CvcvRuDYDzTOzfKKgh:localhost&quot;
}
</pre>
<p>The &quot;room alias&quot; is a human-readable string which can be shared with other users
so they can join a room, rather than the room ID which is a randomly generated
string. You can have multiple room aliases per room.</p>
<!-- TODO(kegan)
How to add/remove aliases from an existing room. -->
</div>
<p><a class="anchor" id="sending-messages"></a></p>
<div class="section" id="sending-messages">
<h2>Sending messages</h2>
<p>You can now send messages to this room:</p>
<pre class="literal-block">
curl -XPOST -d '{&quot;msgtype&quot;:&quot;m.text&quot;, &quot;body&quot;:&quot;hello&quot;}' &quot;http://localhost:8008/_matrix/client/api/v1/rooms/%21CvcvRuDYDzTOzfKKgh%3Alocalhost/send/m.room.message?access_token=YOUR_ACCESS_TOKEN&quot;

{
    &quot;event_id&quot;: &quot;YUwRidLecu&quot;
}
</pre>
<p>The event ID returned is a unique ID which identifies this message.</p>
<p>NB: There are no limitations to the types of messages which can be exchanged.
The only requirement is that <tt class="docutils literal">&quot;msgtype&quot;</tt> is specified. The Matrix
specification outlines the following standard types: <tt class="docutils literal">m.text</tt>, <tt class="docutils literal">m.image</tt>,
<tt class="docutils literal">m.audio</tt>, <tt class="docutils literal">m.video</tt>, <tt class="docutils literal">m.location</tt>, <tt class="docutils literal">m.emote</tt>. See the specification for
more information on these types.</p>
</div>
</div>
<p><a class="anchor" id="users-and-rooms"></a></p>
<div class="section" id="users-and-rooms">
<h1>Users and rooms</h1>
<p>Each room can be configured to allow or disallow certain rules. In particular,
these rules may specify if you require an <strong>invitation</strong> from someone already in
the room in order to <strong>join the room</strong>. In addition, you may also be able to
join a room <strong>via a room alias</strong> if one was set up.</p>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="http://jsfiddle.net/gh/get/jquery/1.8.3/matrix-org/matrix-doc/tree/master/supporting-docs/howtos/jsfiddles/room_memberships">Try out the fiddle</a></p>
</div>
<p><a class="anchor" id="inviting-a-user-to-a-room"></a></p>
<div class="section" id="inviting-a-user-to-a-room">
<h2>Inviting a user to a room</h2>
<p>You can directly invite a user to a room like so:</p>
<pre class="literal-block">
curl -XPOST -d '{&quot;user_id&quot;:&quot;&#64;myfriend:localhost&quot;}' &quot;http://localhost:8008/_matrix/client/api/v1/rooms/%21CvcvRuDYDzTOzfKKgh%3Alocalhost/invite?access_token=YOUR_ACCESS_TOKEN&quot;
</pre>
<p>This informs <tt class="docutils literal">&#64;myfriend:localhost</tt> of the room ID
<tt class="docutils literal">!CvcvRuDYDzTOzfKKgh:localhost</tt> and allows them to join the room.</p>
</div>
<p><a class="anchor" id="joining-a-room-via-an-invite"></a></p>
<div class="section" id="joining-a-room-via-an-invite">
<h2>Joining a room via an invite</h2>
<p>If you receive an invite, you can join the room:</p>
<pre class="literal-block">
curl -XPOST -d '{}' &quot;http://localhost:8008/_matrix/client/api/v1/rooms/%21CvcvRuDYDzTOzfKKgh%3Alocalhost/join?access_token=YOUR_ACCESS_TOKEN&quot;
</pre>
<p>NB: Only the person invited (<tt class="docutils literal">&#64;myfriend:localhost</tt>) can change the membership
state to <tt class="docutils literal">&quot;join&quot;</tt>. Repeatedly joining a room does nothing.</p>
</div>
<p><a class="anchor" id="joining-a-room-via-an-alias"></a></p>
<div class="section" id="joining-a-room-via-an-alias">
<h2>Joining a room via an alias</h2>
<p>Alternatively, if you know the room alias for this room and the room config
allows it, you can directly join a room via the alias:</p>
<pre class="literal-block">
curl -XPOST -d '{}' &quot;http://localhost:8008/_matrix/client/api/v1/join/%23tutorial%3Alocalhost?access_token=YOUR_ACCESS_TOKEN&quot;

{
    &quot;room_id&quot;: &quot;!CvcvRuDYDzTOzfKKgh:localhost&quot;
}
</pre>
<p>You will need to use the room ID when sending messages, not the room alias.</p>
<p>NB: If the room is configured to be an invite-only room, you will still require
an invite in order to join the room even though you know the room alias. As a
result, it is more common to see a room alias in relation to a public room,
which do not require invitations.</p>
</div>
</div>
<p><a class="anchor" id="getting-events"></a></p>
<div class="section" id="getting-events">
<h1>Getting events</h1>
<p>An event is some interesting piece of data that a client may be interested in.
It can be a message in a room, a room invite, etc. There are many different ways
of getting events, depending on what the client already knows.</p>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="http://jsfiddle.net/gh/get/jquery/1.8.3/matrix-org/matrix-doc/tree/master/supporting-docs/howtos/jsfiddles/event_stream">Try out the fiddle</a></p>
</div>
<p><a class="anchor" id="getting-all-state"></a></p>
<div class="section" id="getting-all-state">
<h2>Getting all state</h2>
<p>If the client doesn't know any information on the rooms the user is
invited/joined on, they can get all the user's state for all rooms:</p>
<pre class="literal-block">
curl -XGET &quot;http://localhost:8008/_matrix/client/api/v1/initialSync?access_token=YOUR_ACCESS_TOKEN&quot;

{
    &quot;end&quot;: &quot;s39_18_0&quot;,
    &quot;presence&quot;: [
        {
            &quot;content&quot;: {
                &quot;last_active_ago&quot;: 1061436,
                &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
            },
            &quot;type&quot;: &quot;m.presence&quot;
        }
    ],
    &quot;rooms&quot;: [
        {
            &quot;membership&quot;: &quot;join&quot;,
            &quot;messages&quot;: {
                &quot;chunk&quot;: [
                    {
                        &quot;content&quot;: {
                            &quot;&#64;example:localhost&quot;: 10,
                            &quot;default&quot;: 0
                        },
                        &quot;event_id&quot;: &quot;wAumPSTsWF&quot;,
                        &quot;required_power_level&quot;: 10,
                        &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                        &quot;state_key&quot;: &quot;&quot;,
                        &quot;ts&quot;: 1409665585188,
                        &quot;type&quot;: &quot;m.room.power_levels&quot;,
                        &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                    },
                    {
                        &quot;content&quot;: {
                            &quot;join_rule&quot;: &quot;public&quot;
                        },
                        &quot;event_id&quot;: &quot;jrLVqKHKiI&quot;,
                        &quot;required_power_level&quot;: 10,
                        &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                        &quot;state_key&quot;: &quot;&quot;,
                        &quot;ts&quot;: 1409665585188,
                        &quot;type&quot;: &quot;m.room.join_rules&quot;,
                        &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                    },
                    {
                        &quot;content&quot;: {
                            &quot;level&quot;: 10
                        },
                        &quot;event_id&quot;: &quot;WpmTgsNWUZ&quot;,
                        &quot;required_power_level&quot;: 10,
                        &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                        &quot;state_key&quot;: &quot;&quot;,
                        &quot;ts&quot;: 1409665585188,
                        &quot;type&quot;: &quot;m.room.add_state_level&quot;,
                        &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                    },
                    {
                        &quot;content&quot;: {
                            &quot;level&quot;: 0
                        },
                        &quot;event_id&quot;: &quot;qUMBJyKsTQ&quot;,
                        &quot;required_power_level&quot;: 10,
                        &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                        &quot;state_key&quot;: &quot;&quot;,
                        &quot;ts&quot;: 1409665585188,
                        &quot;type&quot;: &quot;m.room.send_event_level&quot;,
                        &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                    },
                    {
                        &quot;content&quot;: {
                            &quot;ban_level&quot;: 5,
                            &quot;kick_level&quot;: 5
                        },
                        &quot;event_id&quot;: &quot;YAaDmKvoUW&quot;,
                        &quot;required_power_level&quot;: 10,
                        &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                        &quot;state_key&quot;: &quot;&quot;,
                        &quot;ts&quot;: 1409665585188,
                        &quot;type&quot;: &quot;m.room.ops_levels&quot;,
                        &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                    },
                    {
                        &quot;content&quot;: {
                            &quot;avatar_url&quot;: null,
                            &quot;displayname&quot;: null,
                            &quot;membership&quot;: &quot;join&quot;
                        },
                        &quot;event_id&quot;: &quot;RJbPMtCutf&quot;,
                        &quot;membership&quot;: &quot;join&quot;,
                        &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                        &quot;state_key&quot;: &quot;&#64;example:localhost&quot;,
                        &quot;ts&quot;: 1409665586730,
                        &quot;type&quot;: &quot;m.room.member&quot;,
                        &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                    },
                    {
                        &quot;content&quot;: {
                            &quot;body&quot;: &quot;hello&quot;,
                            &quot;hsob_ts&quot;: 1409665660439,
                            &quot;msgtype&quot;: &quot;m.text&quot;
                        },
                        &quot;event_id&quot;: &quot;YUwRidLecu&quot;,
                        &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                        &quot;ts&quot;: 1409665660439,
                        &quot;type&quot;: &quot;m.room.message&quot;,
                        &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                    },
                    {
                        &quot;content&quot;: {
                            &quot;membership&quot;: &quot;invite&quot;
                        },
                        &quot;event_id&quot;: &quot;YjNuBKnPsb&quot;,
                        &quot;membership&quot;: &quot;invite&quot;,
                        &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                        &quot;state_key&quot;: &quot;&#64;myfriend:localhost&quot;,
                        &quot;ts&quot;: 1409666426819,
                        &quot;type&quot;: &quot;m.room.member&quot;,
                        &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                    },
                    {
                        &quot;content&quot;: {
                            &quot;avatar_url&quot;: null,
                            &quot;displayname&quot;: null,
                            &quot;membership&quot;: &quot;join&quot;,
                            &quot;prev&quot;: &quot;join&quot;
                        },
                        &quot;event_id&quot;: &quot;KWwdDjNZnm&quot;,
                        &quot;membership&quot;: &quot;join&quot;,
                        &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                        &quot;state_key&quot;: &quot;&#64;example:localhost&quot;,
                        &quot;ts&quot;: 1409666551582,
                        &quot;type&quot;: &quot;m.room.member&quot;,
                        &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                    },
                    {
                        &quot;content&quot;: {
                            &quot;avatar_url&quot;: null,
                            &quot;displayname&quot;: null,
                            &quot;membership&quot;: &quot;join&quot;
                        },
                        &quot;event_id&quot;: &quot;JFLVteSvQc&quot;,
                        &quot;membership&quot;: &quot;join&quot;,
                        &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                        &quot;state_key&quot;: &quot;&#64;example:localhost&quot;,
                        &quot;ts&quot;: 1409666587265,
                        &quot;type&quot;: &quot;m.room.member&quot;,
                        &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                    }
                ],
                &quot;end&quot;: &quot;s39_18_0&quot;,
                &quot;start&quot;: &quot;t1-11_18_0&quot;
            },
            &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
            &quot;state&quot;: [
                {
                    &quot;content&quot;: {
                        &quot;creator&quot;: &quot;&#64;example:localhost&quot;
                    },
                    &quot;event_id&quot;: &quot;dMUoqVTZca&quot;,
                    &quot;required_power_level&quot;: 10,
                    &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                    &quot;state_key&quot;: &quot;&quot;,
                    &quot;ts&quot;: 1409665585188,
                    &quot;type&quot;: &quot;m.room.create&quot;,
                    &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                },
                {
                    &quot;content&quot;: {
                        &quot;&#64;example:localhost&quot;: 10,
                        &quot;default&quot;: 0
                    },
                    &quot;event_id&quot;: &quot;wAumPSTsWF&quot;,
                    &quot;required_power_level&quot;: 10,
                    &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                    &quot;state_key&quot;: &quot;&quot;,
                    &quot;ts&quot;: 1409665585188,
                    &quot;type&quot;: &quot;m.room.power_levels&quot;,
                    &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                },
                {
                    &quot;content&quot;: {
                        &quot;join_rule&quot;: &quot;public&quot;
                    },
                    &quot;event_id&quot;: &quot;jrLVqKHKiI&quot;,
                    &quot;required_power_level&quot;: 10,
                    &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                    &quot;state_key&quot;: &quot;&quot;,
                    &quot;ts&quot;: 1409665585188,
                    &quot;type&quot;: &quot;m.room.join_rules&quot;,
                    &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                },
                {
                    &quot;content&quot;: {
                        &quot;level&quot;: 10
                    },
                    &quot;event_id&quot;: &quot;WpmTgsNWUZ&quot;,
                    &quot;required_power_level&quot;: 10,
                    &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                    &quot;state_key&quot;: &quot;&quot;,
                    &quot;ts&quot;: 1409665585188,
                    &quot;type&quot;: &quot;m.room.add_state_level&quot;,
                    &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                },
                {
                    &quot;content&quot;: {
                        &quot;level&quot;: 0
                    },
                    &quot;event_id&quot;: &quot;qUMBJyKsTQ&quot;,
                    &quot;required_power_level&quot;: 10,
                    &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                    &quot;state_key&quot;: &quot;&quot;,
                    &quot;ts&quot;: 1409665585188,
                    &quot;type&quot;: &quot;m.room.send_event_level&quot;,
                    &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                },
                {
                    &quot;content&quot;: {
                        &quot;ban_level&quot;: 5,
                        &quot;kick_level&quot;: 5
                    },
                    &quot;event_id&quot;: &quot;YAaDmKvoUW&quot;,
                    &quot;required_power_level&quot;: 10,
                    &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                    &quot;state_key&quot;: &quot;&quot;,
                    &quot;ts&quot;: 1409665585188,
                    &quot;type&quot;: &quot;m.room.ops_levels&quot;,
                    &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                },
                {
                    &quot;content&quot;: {
                        &quot;membership&quot;: &quot;invite&quot;
                    },
                    &quot;event_id&quot;: &quot;YjNuBKnPsb&quot;,
                    &quot;membership&quot;: &quot;invite&quot;,
                    &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                    &quot;state_key&quot;: &quot;&#64;myfriend:localhost&quot;,
                    &quot;ts&quot;: 1409666426819,
                    &quot;type&quot;: &quot;m.room.member&quot;,
                    &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                },
                {
                    &quot;content&quot;: {
                        &quot;avatar_url&quot;: null,
                        &quot;displayname&quot;: null,
                        &quot;membership&quot;: &quot;join&quot;
                    },
                    &quot;event_id&quot;: &quot;JFLVteSvQc&quot;,
                    &quot;membership&quot;: &quot;join&quot;,
                    &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                    &quot;state_key&quot;: &quot;&#64;example:localhost&quot;,
                    &quot;ts&quot;: 1409666587265,
                    &quot;type&quot;: &quot;m.room.member&quot;,
                    &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                }
            ]
        }
    ]
}
</pre>
<p>This returns all the room information the user is invited/joined on, as well as
all of the presences relevant for these rooms. This can be a LOT of data. You
may just want the most recent event for each room. This can be achieved by
applying query parameters to <tt class="docutils literal">limit</tt> this request:</p>
<pre class="literal-block">
curl -XGET &quot;http://localhost:8008/_matrix/client/api/v1/initialSync?limit=1&amp;access_token=YOUR_ACCESS_TOKEN&quot;

{
    &quot;end&quot;: &quot;s39_18_0&quot;,
    &quot;presence&quot;: [
        {
            &quot;content&quot;: {
                &quot;last_active_ago&quot;: 1279484,
                &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
            },
            &quot;type&quot;: &quot;m.presence&quot;
        }
    ],
    &quot;rooms&quot;: [
        {
            &quot;membership&quot;: &quot;join&quot;,
            &quot;messages&quot;: {
                &quot;chunk&quot;: [
                    {
                        &quot;content&quot;: {
                            &quot;avatar_url&quot;: null,
                            &quot;displayname&quot;: null,
                            &quot;membership&quot;: &quot;join&quot;
                        },
                        &quot;event_id&quot;: &quot;JFLVteSvQc&quot;,
                        &quot;membership&quot;: &quot;join&quot;,
                        &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                        &quot;state_key&quot;: &quot;&#64;example:localhost&quot;,
                        &quot;ts&quot;: 1409666587265,
                        &quot;type&quot;: &quot;m.room.member&quot;,
                        &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                    }
                ],
                &quot;end&quot;: &quot;s39_18_0&quot;,
                &quot;start&quot;: &quot;t10-30_18_0&quot;
            },
            &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
            &quot;state&quot;: [
                {
                    &quot;content&quot;: {
                        &quot;creator&quot;: &quot;&#64;example:localhost&quot;
                    },
                    &quot;event_id&quot;: &quot;dMUoqVTZca&quot;,
                    &quot;required_power_level&quot;: 10,
                    &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                    &quot;state_key&quot;: &quot;&quot;,
                    &quot;ts&quot;: 1409665585188,
                    &quot;type&quot;: &quot;m.room.create&quot;,
                    &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                },
                {
                    &quot;content&quot;: {
                        &quot;&#64;example:localhost&quot;: 10,
                        &quot;default&quot;: 0
                    },
                    &quot;event_id&quot;: &quot;wAumPSTsWF&quot;,
                    &quot;required_power_level&quot;: 10,
                    &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                    &quot;state_key&quot;: &quot;&quot;,
                    &quot;ts&quot;: 1409665585188,
                    &quot;type&quot;: &quot;m.room.power_levels&quot;,
                    &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                },
                {
                    &quot;content&quot;: {
                        &quot;join_rule&quot;: &quot;public&quot;
                    },
                    &quot;event_id&quot;: &quot;jrLVqKHKiI&quot;,
                    &quot;required_power_level&quot;: 10,
                    &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                    &quot;state_key&quot;: &quot;&quot;,
                    &quot;ts&quot;: 1409665585188,
                    &quot;type&quot;: &quot;m.room.join_rules&quot;,
                    &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                },
                {
                    &quot;content&quot;: {
                        &quot;level&quot;: 10
                    },
                    &quot;event_id&quot;: &quot;WpmTgsNWUZ&quot;,
                    &quot;required_power_level&quot;: 10,
                    &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                    &quot;state_key&quot;: &quot;&quot;,
                    &quot;ts&quot;: 1409665585188,
                    &quot;type&quot;: &quot;m.room.add_state_level&quot;,
                    &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                },
                {
                    &quot;content&quot;: {
                        &quot;level&quot;: 0
                    },
                    &quot;event_id&quot;: &quot;qUMBJyKsTQ&quot;,
                    &quot;required_power_level&quot;: 10,
                    &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                    &quot;state_key&quot;: &quot;&quot;,
                    &quot;ts&quot;: 1409665585188,
                    &quot;type&quot;: &quot;m.room.send_event_level&quot;,
                    &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                },
                {
                    &quot;content&quot;: {
                        &quot;ban_level&quot;: 5,
                        &quot;kick_level&quot;: 5
                    },
                    &quot;event_id&quot;: &quot;YAaDmKvoUW&quot;,
                    &quot;required_power_level&quot;: 10,
                    &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                    &quot;state_key&quot;: &quot;&quot;,
                    &quot;ts&quot;: 1409665585188,
                    &quot;type&quot;: &quot;m.room.ops_levels&quot;,
                    &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                },
                {
                    &quot;content&quot;: {
                        &quot;membership&quot;: &quot;invite&quot;
                    },
                    &quot;event_id&quot;: &quot;YjNuBKnPsb&quot;,
                    &quot;membership&quot;: &quot;invite&quot;,
                    &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                    &quot;state_key&quot;: &quot;&#64;myfriend:localhost&quot;,
                    &quot;ts&quot;: 1409666426819,
                    &quot;type&quot;: &quot;m.room.member&quot;,
                    &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                },
                {
                    &quot;content&quot;: {
                        &quot;avatar_url&quot;: null,
                        &quot;displayname&quot;: null,
                        &quot;membership&quot;: &quot;join&quot;
                    },
                    &quot;event_id&quot;: &quot;JFLVteSvQc&quot;,
                    &quot;membership&quot;: &quot;join&quot;,
                    &quot;room_id&quot;: &quot;!MkDbyRqnvTYnoxjLYx:localhost&quot;,
                    &quot;state_key&quot;: &quot;&#64;example:localhost&quot;,
                    &quot;ts&quot;: 1409666587265,
                    &quot;type&quot;: &quot;m.room.member&quot;,
                    &quot;user_id&quot;: &quot;&#64;example:localhost&quot;
                }
            ]
        }
    ]
}
</pre>
</div>
<p><a class="anchor" id="getting-live-state"></a></p>
<div class="section" id="getting-live-state">
<h2>Getting live state</h2>
<p>Once you know which rooms the client has previously interacted with, you need to
listen for incoming events. This can be done like so:</p>
<pre class="literal-block">
curl -XGET &quot;http://localhost:8008/_matrix/client/api/v1/events?access_token=YOUR_ACCESS_TOKEN&quot;

{
    &quot;chunk&quot;: [],
    &quot;end&quot;: &quot;s39_18_0&quot;,
    &quot;start&quot;: &quot;s39_18_0&quot;
}
</pre>
<p>This will block waiting for an incoming event, timing out after several seconds.
Even if there are no new events (as in the example above), there will be some
pagination stream response keys. The client should make subsequent requests
using the value of the <tt class="docutils literal">&quot;end&quot;</tt> key (in this case <tt class="docutils literal">s39_18_0</tt>) as the <tt class="docutils literal">from</tt>
query parameter e.g. <tt class="docutils literal"><span class="pre">http://localhost:8008/_matrix/client/api/v1/events?access</span>
_token=YOUR_ACCESS_TOKEN&amp;from=s39_18_0</tt>. This value should be stored so when the
client reopens your app after a period of inactivity, you can resume from where
you got up to in the event stream. If it has been a long period of inactivity,
there may be LOTS of events waiting for the user. In this case, you may wish to
get all state instead and then resume getting live state from a newer end token.</p>
<p>NB: The timeout can be changed by adding a <tt class="docutils literal">timeout</tt> query parameter, which is
in milliseconds. A timeout of 0 will not block.</p>
</div>
<p><a class="anchor" id="example-application"></a></p>
<div class="section" id="example-application">
<h2>Example application</h2>
<p>The following example demonstrates registration and login, live event streaming,
creating and joining rooms, sending messages, getting member lists and getting
historical messages for a room. This covers most functionality of a messaging
application.</p>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="http://jsfiddle.net/gh/get/jquery/1.8.3/matrix-org/matrix-doc/tree/master/supporting-docs/howtos/jsfiddles/example_app">Try out the fiddle</a></p>
</div>
</div>
</div>
</div>

</body>
</html>
