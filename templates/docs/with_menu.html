{% extends "section.html" %}
{% block content %}

{# We always want to display the menu of the chat basics docs #}
{% set root_section = get_section(path="docs/chat_basics/_index.md") %}
{% if section.path is starting_with("/docs/chat_basics") %}
    {% set root_section = get_section(path="docs/chat_basics/_index.md") %}
{% elif section.path is starting_with("/docs/communities") %}
    {% set root_section = get_section(path="docs/communities/_index.md") %}
{% elif section.path is starting_with("/docs/technical") %}
    {% set root_section = get_section(path="docs/technical/_index.md") %}
{% endif %}

<div class="docs-body">
    <div class="docs-menu">
        {% if section.path == root_section.path %}
            {% set current = true %}
        {% else %}
            {% set current = false %}
        {% endif %}
        <div>
            <input id="{{ root_section.title }}-submenu-checkbox" type="checkbox" class="submenu-checkbox" aria-hidden="true" {% if current %}checked{% endif %}>
            <label for="{{ root_section.title }}-submenu-checkbox" class="submenu-title">{{ root_section.title }}<div class="arrow"></div></label>
            <ul class="section-submenu-wrap">
                <a href="{{ root_section.path }}"><li>Overview</li></a>
                {% for h2 in root_section.toc %}
                <li>
                    <a href="{{ h2.permalink }}">{{ h2.title }}</a>
                    {% if h2.children %}
                    <ul>
                    {% for h3 in h2.children %}
                        <a href="{{ h3.permalink }}"><li>{{ h3.title }}</li></a>
                    {% endfor %}
                    </ul>
                    {% endif %}
                </li>
                {% endfor %}
            </ul>
        </div>
        {% for subsection_path in root_section.subsections %}
        {% set subsection = get_section(path=subsection_path) %}
        {% if section.path == subsection.path %}
            {% set current = true %}
        {% else %}
            {% set current = false %}
        {% endif %}
        <div>
            <input id="{{ loop.index }}-submenu-checkbox" type="checkbox" class="submenu-checkbox" aria-hidden="true" {% if current %}checked{% endif %}>
            <label for="{{ loop.index }}-submenu-checkbox" class="submenu-title">{{ subsection.title }}<div class="arrow"></div></label>
            <ul class="section-submenu-wrap">
                <a href="{{ subsection.path }}"><li>Overview</li></a>
                {% for h2 in subsection.toc %}
                <li>
                    <a href="{{ h2.permalink }}">{{ h2.title }}</a>
                    {% if h2.children %}
                    <ul>
                    {% for h3 in h2.children %}
                        <a href="{{ h3.permalink }}"><li>{{ h3.title }}</li></a>
                    {% endfor %}
                    </ul>
                    {% endif %}
                </li>
                {% endfor %}
            </ul>
        </div>
        {% endfor %}
    </div>
    <div class="docs-content">
        <article class="content">
            <header>
                <h1>{{ section.title }}</h1>
                {% set iso_date = section.extra.updated | date(format = '%Y-%m-%d') %}
                <span class="last-updated">
                    Last updated: <time datetime="{{ iso_date }}"> {{ iso_date }}</time>
                </span>
            </header>

            {{ section.content | markdown | safe }}
        </article>
    </div>
</div>
{% endblock content %}
