{% extends "section.html" %}
{% block content %}

{# We always want to display the menu of the communities docs #}
{% set communities_section = get_section(path="docs/communities/_index.md") %}
<div class="docs-body">
    <div class="docs-menu">
        {% if section.path == "/docs/communities/" %}
            {% set current = true %}
        {% else %}
            {% set current = false %}
        {% endif %}
        <details {% if current %}open{% endif %} class="section-header-container">
            <summary {% if current %}class="current"{% endif %}>{{ communities_section.title }} <div class="arrow"></div></summary>
            <ul>
                <li><a href="{{ communities_section.path }}">Overview</a></li>
                {% for h2 in communities_section.toc %}
                <li><a href="{{ h2.permalink }}">{{ h2.title }}</a></li>
                {% endfor %}
            </ul>
        </details>
        {% for subsection_path in communities_section.subsections %}
        {% set subsection = get_section(path=subsection_path) %}
        {% if section.path == subsection.path %}
            {% set current = true %}
        {% else %}
            {% set current = false %}
        {% endif %}
        <details {% if current %}open{% endif %} class="section-header-container">
            <summary {% if current %}class="current"{% endif %}>{{ subsection.title }} <div class="arrow"></div></summary>
            <ul>
                <li><a href="{{ subsection.path }}">Overview</a></li>
                {% for h2 in subsection.toc %}
                <li><a href="{{ h2.permalink }}">{{ h2.title }}</a></li>
                {% endfor %}
            </ul>
        </details>
        {% endfor %}
    </div>
    <div class="docs-content">
        <article class="content">
            <header>
                <h1>{{ section.title }}</h1>
                {% set iso_date = section.extra.updated | date(format = '%Y-%m-%d') %}
                <span class="last-updated">
                    Last updated: <time datetime="{{ iso_date }}"> {{ iso_date }}</time>
                </span>
            </header>

            {{ section.content | markdown | safe }}

            <div class="docs-grid">
            {% for subsection_path in section.subsections %}
            {% set subsection = get_section(path=subsection_path) %}
                <a href="{{ subsection.path }}" class="doc-section-tile">
                    <span class="emoji">{{ subsection.extra.emoji }}</span>
                    <h2>{{ subsection.extra.tile }}</h2>
                </a>
            {% endfor %}
            </div>
        </article>
    </div>
</div>
{% endblock content %}
